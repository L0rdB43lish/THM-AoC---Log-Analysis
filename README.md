# Advent of Cyber 2022 - Day 2 - Log analysis
**Summary:** Santa's SOC has noticed one of their web servers,Â [santagift.shop](http://santagift.shop/) has been hijacked by an APT group. The task is to analyse the log files captured by the web server to understand what is happening and track down the APT group.

**Overview:** The challenge focused on detecting malicious activity through log analysis. As a Security Analyst, I was tasked with investigating an incident on Santa's website ([santagift.shop](http://santagift.shop/)) by reviewing web server logs to uncover any suspicious behaviour and identify the attacker's actions.

**Objectives:**
- analyse web server logs to identify malicious activities
- investigate whether an attacker exfiltrated sensitive data
- pinpoint the attacker's IP address and when the invasion occurred
- locate any files accessed or stolen by the attacker

## Lab
1 - How many log files are present?  
We have two log files on the current directory `/home/elfmcblue`, "SSHD.log" and "webserver.log".  
![log files](https://github.com/L0rdB43lish/THM-AoC---Log-Analysis/blob/61d3b06eca4990d4c35c564135a7414479bbed58/Pasted%20image%2020250508232840.png)

2 - Elf McSkidy managed to capture the logs generated by the web server.  
What is the name of this log file?  
"webserver.log"

3 - On what day was Santa's naughty and nice list stolen?  
Looking through the "webserver.log" file, we see various events that happened on Friday, 18/Nov/2022.  
![event day](https://github.com/L0rdB43lish/THM-AoC---Log-Analysis/blob/61d3b06eca4990d4c35c564135a7414479bbed58/Pasted%20image%2020250508235114.png)

4 - What is the IP address of the attacker?  
Lot of entries show the attacker's IP, which is ``10.10.249.191``.  
![attackers IP](https://github.com/L0rdB43lish/THM-AoC---Log-Analysis/blob/61d3b06eca4990d4c35c564135a7414479bbed58/Pasted%20image%2020250509000047.png)

5 - What is the name of the important list that the attacker stole from Santa?  
When I searched for "list" there were a lot of entries, so I tried searching for ".txt".
Which still gave me a lot of entries but I managed to find the file.  
![santas file](https://github.com/L0rdB43lish/THM-AoC---Log-Analysis/blob/61d3b06eca4990d4c35c564135a7414479bbed58/Pasted%20image%2020250509002214.png)

6 - Look through the log files for the flag. The format of the flag is: "THM{}"  
The flag is in the other file.  
![flag](https://github.com/L0rdB43lish/THM-AoC---Log-Analysis/blob/61d3b06eca4990d4c35c564135a7414479bbed58/Pasted%20image%2020250509002804.png)

## What I learned
In this lab, I learned how to analyse security logs to identify signs of malicious activity. The lab focused on investigating suspicious behaviour in system logs, highlighting the importance of log management in threat detection and incident response.
By the end of the lab, I was able to identify the attacker's IP address, the exploited login credentials, and the exact time of compromise.
